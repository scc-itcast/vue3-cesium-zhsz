{"version":3,"file":"event.mjs","sources":["../../../../../packages/utils/private/event.ts"],"sourcesContent":["export const listenOpts = {\n  hasPassive: false,\n  passiveCapture: true,\n  notPassiveCapture: true,\n  passive: undefined\n}\n\ntry {\n  const opts = Object.defineProperty({}, 'passive', {\n    get() {\n      Object.assign(listenOpts, {\n        hasPassive: true,\n        passive: { passive: true },\n        notPassive: { passive: false },\n        passiveCapture: { passive: true, capture: true },\n        notPassiveCapture: { passive: false, capture: true }\n      })\n    }\n  })\n  window.addEventListener('qtest', null as any, opts)\n  window.removeEventListener('qtest', null as any, opts)\n} catch (e) {\n  //\n}\n\n// eslint-disable-next-line @typescript-eslint/no-empty-function\nexport function noop() {}\n\nexport function leftClick(e) {\n  return e.button === 0\n}\n\nexport function middleClick(e) {\n  return e.button === 1\n}\n\nexport function rightClick(e) {\n  return e.button === 2\n}\n\nexport function position(e) {\n  if (e.touches && e.touches[0]) {\n    e = e.touches[0]\n  } else if (e.changedTouches && e.changedTouches[0]) {\n    e = e.changedTouches[0]\n  } else if (e.targetTouches && e.targetTouches[0]) {\n    e = e.targetTouches[0]\n  }\n\n  return {\n    top: e.clientY,\n    left: e.clientX\n  }\n}\n\nexport function getEventPath(e) {\n  if (e.path) {\n    return e.path\n  }\n  if (e.composedPath) {\n    return e.composedPath()\n  }\n\n  const path: Array<Document | Window> = []\n  let el = e.target\n\n  while (el) {\n    path.push(el)\n\n    if (el.tagName === 'HTML') {\n      path.push(document)\n      path.push(window)\n      return path\n    }\n\n    el = el.parentElement\n  }\n}\n\n// Reasonable defaults\nconst LINE_HEIGHT = 40,\n  PAGE_HEIGHT = 800\n\nexport function getMouseWheelDistance(e) {\n  let x = e.deltaX,\n    y = e.deltaY\n\n  if ((x || y) && e.deltaMode) {\n    const multiplier = e.deltaMode === 1 ? LINE_HEIGHT : PAGE_HEIGHT\n    x *= multiplier\n    y *= multiplier\n  }\n\n  if (e.shiftKey && !x) {\n    ;[y, x] = [x, y]\n  }\n\n  return { x, y }\n}\n\nexport function stop(e) {\n  e.stopPropagation()\n}\n\nexport function prevent(e) {\n  e.cancelable !== false && e.preventDefault()\n}\n\nexport function stopAndPrevent(e) {\n  e.cancelable !== false && e.preventDefault()\n  e.stopPropagation()\n}\n\nexport function preventDraggable(el, status) {\n  if (el === void 0 || (status === true && el.__dragPrevented === true)) {\n    return\n  }\n\n  const fn =\n    status === true\n      ? el => {\n          el.__dragPrevented = true\n          el.addEventListener('dragstart', prevent, listenOpts.notPassiveCapture)\n        }\n      : el => {\n          delete el.__dragPrevented\n          el.removeEventListener('dragstart', prevent, listenOpts.notPassiveCapture)\n        }\n\n  el.querySelectorAll('a, img').forEach(fn)\n}\n\nexport function addEvt(ctx, targetName, events) {\n  const name = `__vc_${targetName}_evt`\n\n  ctx[name] = ctx[name] !== void 0 ? ctx[name].concat(events) : events\n\n  events.forEach(evt => {\n    evt[0].addEventListener(evt[1], ctx[evt[2]], listenOpts[evt[3]])\n  })\n}\n\nexport function cleanEvt(ctx, targetName) {\n  const name = `__vc_${targetName}_evt`\n\n  if (ctx[name] !== void 0) {\n    ctx[name].forEach(evt => {\n      evt[0].removeEventListener(evt[1], ctx[evt[2]], listenOpts[evt[3]])\n    })\n    ctx[name] = void 0\n  }\n}\n\n/*\n * also update /types/utils/event.d.ts\n */\n\nexport default {\n  listenOpts,\n  leftClick,\n  middleClick,\n  rightClick,\n  position,\n  getEventPath,\n  getMouseWheelDistance,\n  stop,\n  prevent,\n  stopAndPrevent,\n  preventDraggable\n}\n"],"names":[],"mappings":"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"}