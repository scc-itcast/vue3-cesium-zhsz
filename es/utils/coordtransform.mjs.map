{"version":3,"file":"coordtransform.mjs","sources":["../../../../packages/utils/coordtransform.ts"],"sourcesContent":["/* eslint-disable */\n/**\n * Created by Wandergis on 2015/7/8. coordtransform.js@2.1.2\n * 提供了百度坐标（BD-09）、国测局坐标（火星坐标，GCJ-02）、和 WGS-84 坐标系之间的转换\n * https://github.com/wandergis/coordtransform\n */\n// 定义一些常量\nconst x_PI = (3.14159265358979324 * 3000.0) / 180.0\nconst PI = 3.1415926535897932384626\nconst a = 6378245.0\nconst ee = 0.00669342162296594323\n/**\n * 百度坐标系 (BD-09) 与 火星坐标系 (GCJ-02) 的转换\n * 即 百度 转 谷歌、高德\n * @param bd_lng\n * @param bd_lat\n * @returns {*[]}\n */\nconst bd09togcj02 = function bd09togcj02(bd_lng: number, bd_lat: number) {\n  var bd_lng = +bd_lng\n  var bd_lat = +bd_lat\n  const x = bd_lng - 0.0065\n  const y = bd_lat - 0.006\n  const z = Math.sqrt(x * x + y * y) - 0.00002 * Math.sin(y * x_PI)\n  const theta = Math.atan2(y, x) - 0.000003 * Math.cos(x * x_PI)\n  const gg_lng = z * Math.cos(theta)\n  const gg_lat = z * Math.sin(theta)\n  return [gg_lng, gg_lat]\n}\n\n/**\n * 火星坐标系 (GCJ-02) 与百度坐标系 (BD-09) 的转换\n * 即 谷歌、高德 转 百度\n * @param lng\n * @param lat\n * @returns {*[]}\n */\nconst gcj02tobd09 = function gcj02tobd09(lng: number, lat: number) {\n  var lat = +lat\n  var lng = +lng\n  const z = Math.sqrt(lng * lng + lat * lat) + 0.00002 * Math.sin(lat * x_PI)\n  const theta = Math.atan2(lat, lng) + 0.000003 * Math.cos(lng * x_PI)\n  const bd_lng = z * Math.cos(theta) + 0.0065\n  const bd_lat = z * Math.sin(theta) + 0.006\n  return [bd_lng, bd_lat]\n}\n\n/**\n * WGS-84 转 GCJ-02\n * @param lng\n * @param lat\n * @returns {*[]}\n */\nconst wgs84togcj02 = function wgs84togcj02(lng: number, lat: number) {\n  var lat = +lat\n  var lng = +lng\n  if (out_of_china(lng, lat)) {\n    return [lng, lat]\n  } else {\n    let dlat = transformlat(lng - 105.0, lat - 35.0)\n    let dlng = transformlng(lng - 105.0, lat - 35.0)\n    const radlat = (lat / 180.0) * PI\n    let magic = Math.sin(radlat)\n    magic = 1 - ee * magic * magic\n    const sqrtmagic = Math.sqrt(magic)\n    dlat = (dlat * 180.0) / (((a * (1 - ee)) / (magic * sqrtmagic)) * PI)\n    dlng = (dlng * 180.0) / ((a / sqrtmagic) * Math.cos(radlat) * PI)\n    const mglat = lat + dlat\n    const mglng = lng + dlng\n    return [mglng, mglat]\n  }\n}\n\n/**\n * GCJ-02 转换为 WGS-84\n * @param lng\n * @param lat\n * @returns {*[]}\n */\nconst gcj02towgs84 = function gcj02towgs84(lng: number, lat: number) {\n  var lat = +lat\n  var lng = +lng\n  if (out_of_china(lng, lat)) {\n    return [lng, lat]\n  } else {\n    let dlat = transformlat(lng - 105.0, lat - 35.0)\n    let dlng = transformlng(lng - 105.0, lat - 35.0)\n    const radlat = (lat / 180.0) * PI\n    let magic = Math.sin(radlat)\n    magic = 1 - ee * magic * magic\n    const sqrtmagic = Math.sqrt(magic)\n    dlat = (dlat * 180.0) / (((a * (1 - ee)) / (magic * sqrtmagic)) * PI)\n    dlng = (dlng * 180.0) / ((a / sqrtmagic) * Math.cos(radlat) * PI)\n    const mglat = lat + dlat\n    const mglng = lng + dlng\n    return [lng * 2 - mglng, lat * 2 - mglat]\n  }\n}\n\nvar transformlat = function transformlat(lng: number, lat: number) {\n  var lat = +lat\n  var lng = +lng\n  let ret = -100.0 + 2.0 * lng + 3.0 * lat + 0.2 * lat * lat + 0.1 * lng * lat + 0.2 * Math.sqrt(Math.abs(lng))\n  ret += ((20.0 * Math.sin(6.0 * lng * PI) + 20.0 * Math.sin(2.0 * lng * PI)) * 2.0) / 3.0\n  ret += ((20.0 * Math.sin(lat * PI) + 40.0 * Math.sin((lat / 3.0) * PI)) * 2.0) / 3.0\n  ret += ((160.0 * Math.sin((lat / 12.0) * PI) + 320 * Math.sin((lat * PI) / 30.0)) * 2.0) / 3.0\n  return ret\n}\n\nvar transformlng = function transformlng(lng: number, lat: number) {\n  var lat = +lat\n  var lng = +lng\n  let ret = 300.0 + lng + 2.0 * lat + 0.1 * lng * lng + 0.1 * lng * lat + 0.1 * Math.sqrt(Math.abs(lng))\n  ret += ((20.0 * Math.sin(6.0 * lng * PI) + 20.0 * Math.sin(2.0 * lng * PI)) * 2.0) / 3.0\n  ret += ((20.0 * Math.sin(lng * PI) + 40.0 * Math.sin((lng / 3.0) * PI)) * 2.0) / 3.0\n  ret += ((150.0 * Math.sin((lng / 12.0) * PI) + 300.0 * Math.sin((lng / 30.0) * PI)) * 2.0) / 3.0\n  return ret\n}\n\n/**\n * 判断是否在国内，不在国内则不做偏移\n * @param lng\n * @param lat\n * @returns {boolean}\n */\nvar out_of_china = function out_of_china(lng: number, lat: number) {\n  var lat = +lat\n  var lng = +lng\n  // 纬度 3.86~53.55, 经度 73.66~135.05\n  return !(lng > 73.66 && lng < 135.05 && lat > 3.86 && lat < 53.55)\n}\n\nexport { bd09togcj02, gcj02tobd09, wgs84togcj02, gcj02towgs84 }\n"],"names":[],"mappings":"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"}